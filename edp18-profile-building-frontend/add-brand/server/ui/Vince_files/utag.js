//tealium universal tag - utag.628 ut4.0.201805311511, Copyright 2018 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
var match=/ut\d\.(\d*)\..*/.exec(utag.cfg.v);if(utag.ut.loader===undefined||!match||parseInt(match[1])<41){u.loader=function(o,a,b,c,l,m){utag.DB(o);a=document;if(o.type=="iframe"){m=a.getElementById(o.id);if(m&&m.tagName=="IFRAME"){b=m;}else{b=a.createElement("iframe");}o.attrs=o.attrs||{};utag.ut.merge(o.attrs,{"height":"1","width":"1","style":"display:none"},0);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";}if(o.id){b.id=o.id;}for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){this.onreadystatechange=null;o.cb();}};}}if(o.type!="img"&&!m){l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}}};}else{u.loader=utag.ut.loader;}
if(utag.ut.encode===undefined){u.encode=function(a,b){b="";try{b=encodeURIComponent(a)}catch(e){utag.DB(e);}if(b==""){b=escape(a);}return b;};}else{u.encode=utag.ut.encode;}
u.ev={"view":1,"link":1};u.map={"search_keyword":"search_query","cp.macys_online_uid":"mt_excl","event_type":"event_type","order_id":"order_id","order_sub_total":"revenue","order_currency":"currency","pipe_delimited_product_category_name":"product_category","pipe_delimited_product_category_id":"product_category_id","pipe_delimited_product_name":"product_name","pipe_delimited_product_price":"product_price","pipe_delimited_product_color":"product_color","customer_postal_code":"billing_postal_code","version":"version","delimiter":"delimiter","dom.referrer":"previous_url","industry":"industry","mt_adid":"mt_adid","mt_id":"mt_id","pipe_delimited_product_id":"product_id","pipe_delimited_product_quantity":"product_quantity","skipsync":"skipsync"};u.extend=[function(a,b){try{if(1){try{b['pipe_delimited_product_category_id']=b.product_category_id.join("|");}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){try{b['pipe_delimited_product_quantity']=b.product_quantity.join("|");}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){try{b['pipe_delimited_product_price']=b.product_price.join("|");}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){try{b['pipe_delimited_product_name']=b.product_name.join("|");}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){try{b['pipe_delimited_product_registry_flag']=b.product_registry_flag.join("|");}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){try{b['pipe_delimited_product_category_name']=b.product_category_name.join("|");}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){try{b['pipe_delimited_product_color']=b.product_color.join("|");}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){utag.ut.sha256=function(h,s){var f={},t=f.lib={},g=function(){},j=t.Base={extend:function(a){g.prototype=this;var c=new g;a&&c.mixIn(a);c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)});c.init.prototype=c;c.$super=this;return c},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},q=t.WordArray=j.extend({init:function(a,c){a=this.words=a||[];this.sigBytes=c!=s?c:4*a.length},toString:function(a){return(a||u).stringify(this)},concat:function(a){var c=this.words,d=a.words,b=this.sigBytes;a=a.sigBytes;this.clamp();if(b%4)for(var e=0;e<a;e++)c[b+e>>>2]|=(d[e>>>2]>>>24-8*(e%4)&255)<<24-8*((b+e)%4);else if(65535<d.length)for(e=0;e<a;e+=4)c[b+e>>>2]=d[e>>>2];else c.push.apply(c,d);this.sigBytes+=a;return this},clamp:function(){var a=this.words,c=this.sigBytes;a[c>>>2]&=4294967295<<32-8*(c%4);a.length=h.ceil(c/4)},clone:function(){var a=j.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var c=[],d=0;d<a;d+=4)c.push(4294967296*h.random()|0);return new q.init(c,a)}}),v=f.enc={},u=v.Hex={stringify:function(a){var c=a.words;a=a.sigBytes;for(var d=[],b=0;b<a;b++){var e=c[b>>>2]>>>24-8*(b%4)&255;d.push((e>>>4).toString(16));d.push((e&15).toString(16))}return d.join("")},parse:function(a){for(var c=a.length,d=[],b=0;b<c;b+=2)d[b>>>3]|=parseInt(a.substr(b,2),16)<<24-4*(b%8);return new q.init(d,c/2)}},k=v.Latin1={stringify:function(a){var c=a.words;a=a.sigBytes;for(var d=[],b=0;b<a;b++)d.push(String.fromCharCode(c[b>>>2]>>>24-8*(b%4)&255));return d.join("")},parse:function(a){for(var c=a.length,d=[],b=0;b<c;b++)d[b>>>2]|=(a.charCodeAt(b)&255)<<24-8*(b%4);return new q.init(d,c)}},l=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(k.stringify(a)))}catch(c){throw Error("Malformed UTF-8 data");}},parse:function(a){return k.parse(unescape(encodeURIComponent(a)))}},x=t.BufferedBlockAlgorithm=j.extend({reset:function(){this._data=new q.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=l.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var c=this._data,d=c.words,b=c.sigBytes,e=this.blockSize,f=b/(4*e),f=a?h.ceil(f):h.max((f|0)-this._minBufferSize,0);a=f*e;b=h.min(4*a,b);if(a){for(var m=0;m<a;m+=e)this._doProcessBlock(d,m);m=d.splice(0,a);c.sigBytes-=b}return new q.init(m,b)},clone:function(){var a=j.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});t.Hasher=x.extend({cfg:j.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){x.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(c,d){return(new a.init(d)).finalize(c)}},_createHmacHelper:function(a){return function(c,d){return(new w.HMAC.init(a,d)).finalize(c)}}});var w=f.algo={};return f}(Math);(function(h){for(var s=utag.ut.sha256,f=s.lib,t=f.WordArray,g=f.Hasher,f=s.algo,j=[],q=[],v=function(a){return 4294967296*(a-(a|0))|0},u=2,k=0;64>k;){var l;a:{l=u;for(var x=h.sqrt(l),w=2;w<=x;w++)if(!(l%w)){l=!1;break a}l=!0}l&&(8>k&&(j[k]=v(h.pow(u,0.5))),q[k]=v(h.pow(u,1/3)),k++);u++}var a=[],f=f.SHA256=g.extend({_doReset:function(){this._hash=new t.init(j.slice(0))},_doProcessBlock:function(c,d){for(var b=this._hash.words,e=b[0],f=b[1],m=b[2],h=b[3],p=b[4],j=b[5],k=b[6],l=b[7],n=0;64>n;n++){if(16>n)a[n]=c[d+n]|0;else{var r=a[n-15],g=a[n-2];a[n]=((r<<25|r>>>7)^(r<<14|r>>>18)^r>>>3)+a[n-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+a[n-16]}r=l+((p<<26|p>>>6)^(p<<21|p>>>11)^(p<<7|p>>>25))+(p&j^~p&k)+q[n]+a[n];g=((e<<30|e>>>2)^(e<<19|e>>>13)^(e<<10|e>>>22))+(e&f^e&m^f&m);l=k;k=j;j=p;p=h+r|0;h=m;m=f;f=e;e=r+g|0}b[0]=b[0]+e|0;b[1]=b[1]+f|0;b[2]=b[2]+m|0;b[3]=b[3]+h|0;b[4]=b[4]+p|0;b[5]=b[5]+j|0;b[6]=b[6]+k|0;b[7]=b[7]+l|0},_doFinalize:function(){var a=this._data,d=a.words,b=8*this._nDataBytes,e=8*a.sigBytes;d[e>>>5]|=128<<24-e%32;d[(e+64>>>9<<4)+14]=h.floor(b/4294967296);d[(e+64>>>9<<4)+15]=b;a.sigBytes=4*d.length;this._process();return this._hash},clone:function(){var a=g.clone.call(this);a._hash=this._hash.clone();return a}});s.SHA256=g._createHelper(f);s.HmacSHA256=g._createHmacHelper(f)})(Math);try{if(typeof b['cp.macys_online_uid']!='undefined'&&b['cp.macys_online_uid']!=''){b['cp.macys_online_uid']=utag.ut.sha256.SHA256(b['cp.macys_online_uid']).toString();}}catch(e){}},function(a,b){try{if(1){b['delimiter']='|';b['version']='1.0';b['industry']='retail';b['skipsync']='F'}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){d=b['page_type'];if(typeof d=='undefined')return;c=[{'order confirmation':'conversion'},{'home page':'home'},{'search results':'search_results'},{'product':'product_detail'},{'product quickview':'product_detail'},{'shopping bag':'view_cart'},{'splash':'category'},{'browse':'category'},{'checkout':'cart'}];var m=false;for(e=0;e<c.length;e++){for(f in c[e]){if(d==f){b['event_type']=c[e][f];m=true};};if(m)break};if(!m)b['event_type']='catchall';},function(a,b,c,d,e,f,g){d=b['page_type'];if(typeof d=='undefined')return;c=[{'order confirmation':'1310255'},{'home page':'1310249'},{'search results':'1310250'},{'product':'1310252'},{'product quickview':'1310252'},{'shopping bag':'1310254'},{'splash':'1310251'},{'browse':'1310251'},{'checkout':'1319666'}];var m=false;for(e=0;e<c.length;e++){for(f in c[e]){if(d==f){b['mt_id']=c[e][f];m=true};};if(m)break};if(!m)b['mt_id']='1310256';},function(a,b,c,d,e,f,g){d=b['event_name'];if(typeof d=='undefined')return;c=[{'add_to_bag':'add_cart'}];var m=false;for(e=0;e<c.length;e++){for(f in c[e]){if(d==f){b['event_type']=c[e][f];m=true};};if(m)break};},function(a,b,c,d,e,f,g){d=b['event_name'];if(typeof d=='undefined')return;c=[{'add_to_bag':'1310253'}];var m=false;for(e=0;e<c.length;e++){for(f in c[e]){if(d==f){b['mt_id']=c[e][f];m=true};};if(m)break};}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){utag.DB("send:628");utag.DB(b);var c,d,e,f,_key;u.data={"qsp_delim":"&","base_url":"//pixel.mathtag.com/event/","mt_adid":"208161","mt_id":"","type":"script"||"img","v":{},"s":{}};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:628:EXTENSIONS");utag.DB(b);window.MathTag={};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(e[f].indexOf("v.")===0){u.data.v[e[f].substring(2)]=u.encode(b[d]);}else if(e[f].indexOf("s.")===0){u.data.s[e[f].substring(2)]=u.encode(b[d]);}else{u.data[e[f]]=u.encode(b[d]);}}}}
utag.DB("send:628:MAPPINGS");utag.DB(u.data);if(!u.data.mt_id){utag.DB(u.id+": Tag not fired: Required attribute not populated [mt_id]");return;}
if(!u.data.mt_adid){utag.DB(u.id+": Tag not fired: Required attribute not populated [mt_adid]");return;}
window.MathTag.mt_id=u.data.mt_id;window.MathTag.mt_adid=u.data.mt_adid;if(u.data.mt_pp){window.MathTag.mt_pp=u.data.mt_pp};if(u.data.version){window.MathTag.version=u.data.version};if(u.data.delimiter){window.MathTag.delimiter=u.data.delimiter};if(u.data.industry){window.MathTag.industry=u.data.industry};if(u.data.skipsync){window.MathTag.skipsync=u.data.skipsync};if(u.data.mt_exem){window.MathTag.mt_exem=u.data.mt_exem;}else if(u.data.mt_excl){window.MathTag.mt_excl=u.data.mt_excl;}
if(u.data.event_type){window.MathTag.event_type=u.data.event_type};if(u.data.previous_url){window.MathTag.previous_url=u.data.previous_url};if(u.data.order_id){window.MathTag.order_id=u.data.order_id};if(u.data.revenue){window.MathTag.revenue=u.data.revenue};if(u.data.currency){window.MathTag.currency=u.data.currency};if(u.data.page_name){window.MathTag.page_name=u.data.page_name};if(u.data.search_query){window.MathTag.search_query=u.data.search_query};if(u.data.product_id){window.MathTag.product_id=u.data.product_id};if(u.data.product_category){window.MathTag.product_category=u.data.product_category};if(u.data.product_category_id){window.MathTag.product_category_id=u.data.product_category_id};if(u.data.product_subcategory_1){window.MathTag.product_subcategory_1=u.data.product_subcategory_1};if(u.data.product_name){window.MathTag.product_name=u.data.product_name};if(u.data.product_price){window.MathTag.product_price=u.data.product_price};if(u.data.product_retail_price){window.MathTag.product_retail_price=u.data.product_retail_price};if(u.data.product_discount_price){window.MathTag.product_discount_price=u.data.product_discount_price};if(u.data.product_brand){window.MathTag.product_brand=u.data.product_brand};if(u.data.product_color){window.MathTag.product_color=u.data.product_color};if(u.data.product_quantity){window.MathTag.product_quantity=u.data.product_quantity};if(u.data.product_age_group){window.MathTag.product_age_group=u.data.product_age_group};if(u.data.product_gender){window.MathTag.product_gender=u.data.product_gender};if(u.data.product_status){window.MathTag.product_status=u.data.product_status};if(u.data.client_status){window.MathTag.client_status=u.data.client_status};if(u.data.billing_postal_code){window.MathTag.billing_postal_code=u.data.billing_postal_code};window.MathTag.v1=(u.data.v1||"");window.MathTag.v2=(u.data.v2||"");window.MathTag.v3=(u.data.v3||"");window.MathTag.s1=(u.data.s1||"");window.MathTag.s2=(u.data.s2||"");window.MathTag.s3=(u.data.s3||"");for(_key in u.data.v){window.MathTag["v"+_key]=u.data.v[_key];}
for(_key in u.data.s){window.MathTag["s"+_key]=u.data.s[_key];}
u.data.base_url=u.data.base_url+(u.data.type==="script"?"js":u.data.type)+"?mt_pp=1&mt_adid="+u.data.mt_adid;u.loader({"type":u.data.type,"src":u.data.base_url,"loc":"script","id":"utag_628"});utag.DB("send:628:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("628","macys.main"));}catch(error){utag.DB(error);}
